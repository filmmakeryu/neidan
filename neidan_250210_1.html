<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>ÂÜÖ‰∏πÂØπÂÜ≥</title>
    <style>
        :root {
            --victory-color: #4CAF50;
            --defeat-color: #f44336;
        }
        body {
            font-family: Arial, sans-serif;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background: #f0f2f5;
            text-align: center;
        }
        .status-panel {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 15px 0;
            display: flex;
            justify-content: space-between;
        }
        .battle-log {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 15px 0;
            min-height: 100px;
            position: relative;
            overflow: hidden;
        }
        .result-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            animation: fadeOut 1.5s forwards;
        }
        @keyframes fadeOut {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2); }
        }
        .victory { color: var(--victory-color); }
        .defeat { color: var(--defeat-color); }
        .action-display {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 15px;
            font-size: 1.2em;
            margin: 10px 0;
        }
        .round-number {
            color: #666;
            font-size: 0.9em;
        }
        #actionPanel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .action-btn {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .action-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <h1>ÂÜÖ‰∏πÂØπÂÜ≥</h1>
    
    <div class="status-panel">
        <div>
            <div>Á¢≥Âü∫‰∫∫</div>
            <div>ÂÜÖ‰∏πÔºö<strong id="danA">0</strong></div>
            <div>ËÉúÂà©Ôºö<span id="scoreA">0</span></div>
        </div>
        <div>
            <div>Á°ÖÂü∫‰∫∫</div>
            <div>ÂÜÖ‰∏πÔºö<strong id="danB">0</strong></div>
            <div>ËÉúÂà©Ôºö<span id="scoreB">0</span></div>
        </div>
    </div>

    <div class="battle-log" id="battleLog">
        <div class="action-display" id="currentAction">
            <span id="playerAction">-</span>
            <div>VS</div>
            <span id="botAction">-</span>
        </div>
        <div class="round-number" id="roundNumber">Á¨¨ 0 ÂõûÂêà</div>
    </div>

    <div id="actionPanel">
        <button class="action-btn" style="background: #4CAF50;" id="gatherBtn">ÈõÜ‰∏π</button>
        <button class="action-btn" style="background: #f44336;" id="attackBtn" disabled>ÊîªÂáª</button>
        <button class="action-btn" style="background: #2196F3;" id="defendBtn">Èò≤Âæ°</button>
    </div>

    <button class="action-btn" style="background: #9C27B5; width: 100%;" id="newGameBtn">ÂÖ®Êñ∞ÂºÄÂßã</button>

    <script>
class DanDuel {
    constructor() {
        this.scores = JSON.parse(localStorage.getItem('danScores')) || { A: 0, B: 0 };
        this.reset();
    }

    reset() {
        this.playerA = { dan: 0 };
        this.playerB = { dan: 0 };
        this.round = 1;
        this.updateDisplay();
    }

    getBotAction() {
        // Êô∫ËÉΩAIÂÜ≥Á≠ñÈÄªËæë
        if (this.playerB.dan === 0) return 'ÈõÜ‰∏π';
        if (this.playerA.dan === 0) return Math.random() < 0.8 ? 'ÈõÜ‰∏π' : 'Èò≤Âæ°';
        
        return ['ÈõÜ‰∏π', 'Èò≤Âæ°', 'ÊîªÂáª'][Math.floor(Math.random() * 3)];
    }

    processTurn(playerAction) {
        // È™åËØÅÁé©ÂÆ∂Âä®‰Ωú
        if (playerAction === 'ÊîªÂáª' && this.playerA.dan < 1) {
            playerAction = 'Èò≤Âæ°';
        }

        // AIË°åÂä®
        const botAction = this.getBotAction();

        // Êõ¥Êñ∞Áä∂ÊÄÅ
        this.updateDan(playerAction, botAction);
        this.showActions(playerAction, botAction);

        // Ê£ÄÊü•ÁªìÊûú
        const result = this.checkResult(playerAction, botAction);
        if (result) this.handleResult(result);

        this.round++;
        this.updateDisplay();
    }

    updateDan(playerAction, botAction) {
        // Â§ÑÁêÜÂÜÖ‰∏πÂèòÂåñ
        const actions = {
            'ÈõÜ‰∏π': player => player.dan++,
            'ÊîªÂáª': player => player.dan > 0 ? player.dan-- : null,
            'Èò≤Âæ°': () => {}
        };

        actions[playerAction](this.playerA);
        actions[botAction](this.playerB);
    }

    checkResult(playerAction, botAction) {
        if (playerAction === 'ÊîªÂáª' && botAction === 'ÈõÜ‰∏π') return 'A';
        if (botAction === 'ÊîªÂáª' && playerAction === 'ÈõÜ‰∏π') return 'B';
        return null;
    }

    handleResult(winner) {
        this.scores[winner]++;
        localStorage.setItem('danScores', JSON.stringify(this.scores));
        this.showResultAnimation(winner);
        setTimeout(() => this.reset(), 1500);
    }

    showActions(playerAction, botAction) {
        const actionColors = {
            'ÈõÜ‰∏π': '#4CAF50',
            'ÊîªÂáª': '#f44336',
            'Èò≤Âæ°': '#2196F3'
        };

        document.getElementById('playerAction').style.color = actionColors[playerAction];
        document.getElementById('playerAction').textContent = playerAction;
        document.getElementById('botAction').style.color = actionColors[botAction];
        document.getElementById('botAction').textContent = botAction;
        document.getElementById('roundNumber').textContent = `Á¨¨ ${this.round} ÂõûÂêà`;
    }

    showResultAnimation(result) {
        const log = document.getElementById('battleLog');
        const overlay = document.createElement('div');
        overlay.className = `result-overlay ${result === 'A' ? 'victory' : 'defeat'}`;
        overlay.textContent = result === 'A' ? 'üéâ ËÉúÂà©!' : 'üí• Ë¥•Âåó!';
        
        log.appendChild(overlay);
        setTimeout(() => overlay.remove(), 1500);
    }

    updateDisplay() {
        document.getElementById('danA').textContent = this.playerA.dan;
        document.getElementById('danB').textContent = this.playerB.dan;
        document.getElementById('scoreA').textContent = this.scores.A;
        document.getElementById('scoreB').textContent = this.scores.B;
        document.getElementById('attackBtn').disabled = this.playerA.dan < 1;
    }
}

// ÂàùÂßãÂåñÊ∏∏Êàè
const game = new DanDuel();

// ‰∫ã‰ª∂ÁªëÂÆö
document.getElementById('gatherBtn').addEventListener('click', () => game.processTurn('ÈõÜ‰∏π'));
document.getElementById('attackBtn').addEventListener('click', () => game.processTurn('ÊîªÂáª'));
document.getElementById('defendBtn').addEventListener('click', () => game.processTurn('Èò≤Âæ°'));
document.getElementById('newGameBtn').addEventListener('click', () => {
    game.scores = { A: 0, B: 0 };
    localStorage.removeItem('danScores');
    game.reset();
});
    </script>
</body>
</html>
